Imports System.Data.SqlClient
Imports System.Configuration
Imports System.IO
Public Class DBConnection
    Private objConnection As SqlConnection

    '' -------NOTEPAD CODE --------
    Public Shared oFile As System.IO.File
    Public Shared oRead As System.IO.StreamReader = File.OpenText("C:\DBConnectionString.txt")
    Public Shared ConnectionString As String = oRead.ReadToEnd
    Public WriteOnly Property SetConnection() As String
        Set(ByVal Value As String)
            objConnection = New SqlConnection(Value)
        End Set
    End Property
    Public ReadOnly Property GetConnection() As SqlConnection
        Get
            Return objConnection
        End Get
    End Property
    Public Sub New(ByVal ConnectionString As String)
        Try
            SetConnection = ConnectionString
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
    Public Sub New()
        Try
            Dim ConnectionString As String = DBConnection.ConnectionString
            SetConnection = ConnectionString
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
    Public Sub OpenConnection()
        Try
            GetConnection.Open()
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
    Public Sub CloseConnection()
        Try
            GetConnection.Close()
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
End Class
